<div id="navigation" class="sticky">
  <nav class="top-bar" role="navigation" data-topbar>
    <ul class="title-area">
      <li class="name">
        <h1 class="show-for-small-only">
          <a href="{{ site.url }}{{ site.baseurl }}" class="icon-tree"> {{ site.title }}</a>
        </h1>
      </li>
      <li class="toggle-topbar menu-icon"><a href="#"><span></span></a></li>
    </ul>
    <section class="top-bar-section">
      {% assign sides = site.data.navigation | group_by:"side" | sort:"name" %}
      {% for side in sides %}
      <ul class="{{ side.name }}">
        {% for link in side.items %}

          {% capture isActive %}
          {% if link.url != '/' and page.url contains link.url %}
          active
          {% elsif link.url == '/' and page.url == '/' %}
          active
          {% elsif link.url == '/blog/' and page.collection == 'posts' %}
          active
          {% endif %}
          {% endcapture %}

          {% if link.dropdown == nil %}
            <li class="{{ isActive }}"><a {% if link.class %}class="{{link.class}}"{% endif %} href="{{ link.url | absolute_url }}">{{ link.title | escape }}</a></li>
            <li class="divider"></li>
          {% else %}
            <li class="has-dropdown {{ isActive}}">
              <a {% if link.class %}class="{{link.class}}"{% endif %} href="{{ link.url | absolute_url}}">{{ link.title | escape }}</a>
                <ul class="dropdown">
                  {% for dropdown_link in link.dropdown %}
                    <li><a {% if dropdown_link.class %}class="{{dropdown_link.class}}"{% endif %} href="{{ dropdown_link.url | absolute_url}}">{{ dropdown_link.title | escape }}</a></li>
                  {% endfor %}
                </ul>
            </li>
            <li class="divider"></li>
          {% endif %}
        {% endfor %}
      </ul>
      {% endfor %}
    </section>
  </nav>
</div>
